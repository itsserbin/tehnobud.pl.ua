!function(t){var i,e,a,s,o,r,n,h,l,d;if(i=document.namespaces,has_canvas=!!document.createElement("canvas").getContext,has_canvas||i){has_canvas?(n=function(t){return Math.max(0,Math.min(parseInt(t,16),255))},h=function(t,i){return"rgba("+n(t.substr(0,2))+","+n(t.substr(2,2))+","+n(t.substr(4,2))+","+i+")"},e=function(i){var e=t('<canvas style="width:'+i.width+"px;height:"+i.height+'px;"></canvas>').get(0);return e.getContext("2d").clearRect(0,0,e.width,e.height),e},a=function(i,e,a,s,o){var r,n=i.getContext("2d");if(n.beginPath(),"rect"==e)n.rect(a[0],a[1],a[2]-a[0],a[3]-a[1]);else if("poly"==e)for(n.moveTo(a[0],a[1]),r=2;r<a.length;r+=2)n.lineTo(a[r],a[r+1]);else"circ"==e&&n.arc(a[0],a[1],a[2],0,2*Math.PI,!1);n.closePath(),s.fill&&(n.fillStyle=h(s.fillColor,s.fillOpacity),n.fill()),s.stroke&&(n.strokeStyle=h(s.strokeColor,s.strokeOpacity),n.lineWidth=s.strokeWidth,n.stroke()),s.fade&&t(i).css("opacity",0).animate({opacity:1},100)},s=function(t){t.getContext("2d").clearRect(0,0,t.width,t.height)}):(e=function(i){return t('<var style="zoom:1;overflow:hidden;display:block;width:'+i.width+"px;height:"+i.height+'px;"></var>').get(0)},a=function(i,e,a,s,o){var r,n,h,l;r='<v:fill color="#'+s.fillColor+'" opacity="'+(s.fill?s.fillOpacity:0)+'" />',n=s.stroke?'strokeweight="'+s.strokeWidth+'" stroked="t" strokecolor="#'+s.strokeColor+'"':'stroked="f"',h='<v:stroke opacity="'+s.strokeOpacity+'"/>',"rect"==e?l=t('<v:rect name="'+o+'" filled="t" '+n+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+a[0]+"px;top:"+a[1]+"px;width:"+(a[2]-a[0])+"px;height:"+(a[3]-a[1])+'px;"></v:rect>'):"poly"==e?l=t('<v:shape name="'+o+'" filled="t" '+n+' coordorigin="0,0" coordsize="'+i.width+","+i.height+'" path="m '+a[0]+","+a[1]+" l "+a.join(",")+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+i.width+"px;height:"+i.height+'px;"></v:shape>'):"circ"==e&&(l=t('<v:oval name="'+o+'" filled="t" '+n+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+(a[0]-a[2])+"px;top:"+(a[1]-a[2])+"px;width:"+2*a[2]+"px;height:"+2*a[2]+'px;"></v:oval>')),l.get(0).innerHTML=r+h,t(i).append(l)},s=function(i){t(i).find("[name=highlighted]").remove()}),o=function(t){var i,e=t.getAttribute("coords").split(",");for(i=0;i<e.length;i++)e[i]=parseFloat(e[i]);return[t.getAttribute("shape").toLowerCase().substr(0,4),e]},d=function(i,e){var a=t(i);return t.extend({},e,!!t.metadata&&a.metadata(),a.data("maphilight"))},l=function(t){return!!t.complete&&(void 0===t.naturalWidth||0!=t.naturalWidth)},r={position:"absolute",left:0,top:0,padding:0,border:0};var c=!1;t.fn.maphilight=function(i){if(i=t.extend({},t.fn.maphilight.defaults,i),!has_canvas&&t.browser.msie&&!c){document.namespaces.add("v","urn:schemas-microsoft-com:vml");var n=document.createStyleSheet();t.each(["shape","rect","oval","circ","fill","stroke","imagedata","group","textbox"],(function(){n.addRule("v\\:"+this,"behavior: url(#default#VML); antialias:true")})),c=!0}return this.each((function(){var n,h,c,p,f,g,u,m;if(n=t(this),!l(this))return window.setTimeout((function(){n.maphilight(i)}),200);if(c=t.extend({},i,!!t.metadata&&n.metadata(),n.data("maphilight")),m=n.get(0).getAttribute("usemap"),p=t('map[name="'+m.substr(1)+'"]'),n.is("img")&&m&&p.size()>0){if(n.hasClass("maphilighted")){var v=n.parent();n.insertBefore(v),v.remove(),t(p).unbind(".maphilight").find("area[coords]").unbind(".maphilight")}h=t("<div></div>").css({display:"block",background:'url("'+this.src+'")',position:"relative",padding:0,width:this.width,height:this.height}),c.wrapClass&&(!0===c.wrapClass?h.addClass(t(this).attr("class")):h.addClass(c.wrapClass)),n.before(h).css("opacity",0).css(r).remove(),t.browser.msie&&n.css("filter","Alpha(opacity=0)"),h.append(n),f=e(this),t(f).css(r),f.height=this.height,f.width=this.width,u=function(i){var e,s;if(!(s=d(this,c)).neverOn&&!s.alwaysOn){if(e=o(this),a(f,e[0],e[1],s,"highlighted"),s.groupBy&&t(this).attr(s.groupBy)){var r=this;p.find("area["+s.groupBy+'="'+t(this).attr(s.groupBy)+'"]').each((function(){if(this!=r){var t=d(this,c);if(!t.neverOn&&!t.alwaysOn){var i=o(this);a(f,i[0],i[1],t,"highlighted")}}}))}has_canvas||t(f).append("<v:rect></v:rect>")}},t(p).bind("alwaysOn.maphilight",(function(){g&&s(g),has_canvas||t(f).empty(),t(p).find("area[coords]").each((function(){var i,s;(s=d(this,c)).alwaysOn&&(!g&&has_canvas&&(g=e(n.get()),t(g).css(r),g.width=n.width(),g.height=n.height(),n.before(g)),s.fade=s.alwaysOnFade,i=o(this),has_canvas?a(g,i[0],i[1],s,""):a(f,i[0],i[1],s,""))}))})),t(p).trigger("alwaysOn.maphilight").find("area[coords]").bind("mouseover.maphilight",u).bind("mouseout.maphilight",(function(t){s(f)})),n.before(f),n.addClass("maphilighted")}}))},t.fn.maphilight.defaults={fill:!0,fillColor:"000000",fillOpacity:.2,stroke:!0,strokeColor:"ff0000",strokeOpacity:1,strokeWidth:1,fade:!0,alwaysOn:!1,neverOn:!1,groupBy:!1,wrapClass:!0}}else t.fn.maphilight=function(){return this}}(jQuery);
